---
import { supabase } from '../../lib/supabase'

export const prerender = false;

const { data: { session } } = await supabase.auth.getSession();
if (!session || !session.user.email?.endsWith('@tstr.directory')) {
  return Astro.redirect('/admin/login');
}

const title = 'Admin Dashboard'
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <script>function initApollo(){var n=Math.random().toString(36).substring(7),o=document.createElement("script");
  o.src="https://assets.apollo.io/micro/website-tracker/tracker.iife.js?nocache="+n,o.async=!0,o.defer=!0,
  o.onload=function(){window.trackingFunctions.onLoad({appId:"6979e8021ac917001927e9b2"})},
  document.head.appendChild(o)}initApollo();</script>
</head>
  <body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-8">{title}</h1>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <a href="/admin/dashboard" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <h2 class="text-xl font-semibold text-gray-800 mb-3">Scraper Dashboard</h2>
          <p class="text-gray-600 mb-4">Monitor scraper performance, view metrics by category, and track system health.</p>
          <span class="text-blue-600 font-medium">View Dashboard →</span>
        </a>

        <a href="/admin/analytics" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <h2 class="text-xl font-semibold text-gray-800 mb-3">Analytics</h2>
          <p class="text-gray-600 mb-4">View click tracking analytics and user engagement metrics.</p>
          <span class="text-blue-600 font-medium">View Analytics →</span>
        </a>

        <a href="/admin/claims" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <h2 class="text-xl font-semibold text-gray-800 mb-3">Claims Management</h2>
          <p class="text-gray-600 mb-4">Review and manage business claims for listings ownership.</p>
          <span class="text-orange-600 font-medium">Manage Claims →</span>
        </a>

        <a href="/admin/failed-urls" class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow">
          <h2 class="text-xl font-semibold text-gray-800 mb-3">Failed URLs</h2>
          <p class="text-gray-600 mb-4">Review URLs that failed validation and need manual attention.</p>
          <span class="text-red-600 font-medium">View Failed URLs →</span>
        </a>
      </div>

      <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-blue-800 mb-3">Admin Tools Overview</h3>
        <div class="text-sm text-blue-700 space-y-2">
          <p><strong>Scraper Dashboard:</strong> Real-time monitoring of scraping operations across all categories</p>
          <p><strong>Analytics:</strong> Click tracking and user behavior insights</p>
          <p><strong>Claims Management:</strong> Review and approve/reject business ownership claims</p>
          <p><strong>Failed URLs:</strong> Remedial actions for validation failures</p>
        </div>
      </div>
    </div>
  </body>
</html>