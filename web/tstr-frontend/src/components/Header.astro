---
---

<header style="background: linear-gradient(135deg, #2563EB 0%, #059669 100%); color: white; padding: 3rem 2rem; position: relative;">
  <div class="header-content" style="display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto;">
    <!-- Logo Section -->
    <div class="logo">
      <a href="/" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
        <img src="/TSTR-Logo-60px.png" alt="TSTR Logo" style="height: 60px; width: auto; margin-right: 1.5rem;"/>
        <div>
          <span style="font-size: 2.2rem; line-height: 1; margin-bottom: -0.2rem; letter-spacing: 0.1em; display: block;">TSTR</span>
          <span style="font-size: 2.8rem; line-height: 1; letter-spacing: 0.05em; display: block;">hub</span>
        </div>
      </a>
    </div>

    <!-- Desktop Navigation -->
    <nav id="desktop-nav" class="desktop-nav" style="display: flex; gap: 1rem; align-items: center;">
      <!-- Navigation will be populated by JavaScript -->
    </nav>

    <!-- Mobile Hamburger Menu -->
    <button id="hamburger-btn" class="hamburger-btn" style="display: none; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; padding: 0.5rem;">
      ☰
    </button>
  </div>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu" class="mobile-menu" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; padding-top: 5rem;">
    <div style="background: linear-gradient(135deg, #2563EB 0%, #059669 100%); margin: 2rem; border-radius: 12px; padding: 2rem; text-align: center;">
      <button id="close-menu-btn" style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: white; font-size: 2rem; cursor: pointer;">×</button>
      <nav id="mobile-nav" style="display: flex; flex-direction: column; gap: 1rem;">
        <!-- Mobile navigation will be populated by JavaScript -->
      </nav>
    </div>
  </div>

  <h1 style="font-size: 0; margin-bottom: 0.5rem; font-weight: 700; display: block; text-align: center; margin-top: 2rem;">
    Specialist Testing Services, Products and Solutions Directory
  </h1>
  <p style="font-size: 1rem; margin-top: 0.5rem; opacity: 0.85; text-align: center;">
    Oil & Gas • Biopharma & Life Sciences • Environmental • Materials Testing
  </p>
</header>

<style>
  @media (max-width: 768px) {
    .desktop-nav {
      display: none !important;
    }
    .hamburger-btn {
      display: block !important;
    }
  }
  @media (min-width: 769px) {
    .hamburger-btn {
      display: none !important;
    }
  }
</style>

<script>
  import { supabaseBrowser } from '../lib/supabase-browser'

  function createNavLink(href, text, isPrimary = false) {
    const link = document.createElement('a')
    link.href = href
    link.textContent = text
    link.style.cssText = isPrimary ? `
      background: linear-gradient(135deg, #2563EB 0%, #059669 100%);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      cursor: pointer;
      display: block;
      text-align: center;
      margin-bottom: 0.5rem;
    ` : `
      background: white;
      color: #2563EB;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      cursor: pointer;
      display: block;
      text-align: center;
      margin-bottom: 0.5rem;
    `
    link.onmouseover = () => link.style.transform = 'translateY(-1px)'
    link.onmouseout = () => link.style.transform = 'translateY(0)'
    return link
  }

  async function updateNavigation() {
    try {
      const { data: { session } } = await supabaseBrowser.auth.getSession()
      const isLoggedIn = !!session?.user

      // Update desktop nav
      const desktopNav = document.getElementById('desktop-nav')
      if (desktopNav) {
        desktopNav.innerHTML = ''

        const pricingLink = createNavLink('/pricing', 'Pricing', false)
        const browseLink = createNavLink('/browse', 'Browse', false)

        if (isLoggedIn) {
          const accountLink = createNavLink('/account', 'My Account', true)
          desktopNav.appendChild(accountLink)
        } else {
          const loginLink = createNavLink('/login', 'Login / Register', true)
          desktopNav.appendChild(loginLink)
        }

        desktopNav.appendChild(browseLink)
        desktopNav.appendChild(pricingLink)
      }

      // Update mobile nav
      const mobileNav = document.getElementById('mobile-nav')
      if (mobileNav) {
        mobileNav.innerHTML = ''

        if (isLoggedIn) {
          const accountLink = createNavLink('/account', 'My Account', true)
          mobileNav.appendChild(accountLink)
        } else {
          const loginLink = createNavLink('/login', 'Login / Register', true)
          mobileNav.appendChild(loginLink)
        }

        const browseLink = createNavLink('/browse', 'Browse Listings', false)
        const pricingLink = createNavLink('/pricing', 'Pricing', false)

        mobileNav.appendChild(browseLink)
        mobileNav.appendChild(pricingLink)
      }
    } catch (error) {
      console.error('Error updating navigation:', error)
    }
  }

  // Mobile menu toggle
  function initMobileMenu() {
    const hamburgerBtn = document.getElementById('hamburger-btn')
    const mobileMenu = document.getElementById('mobile-menu')
    const closeBtn = document.getElementById('close-menu-btn')

    if (hamburgerBtn && mobileMenu) {
      hamburgerBtn.addEventListener('click', () => {
        mobileMenu.style.display = 'block'
      })

      if (closeBtn) {
        closeBtn.addEventListener('click', () => {
          mobileMenu.style.display = 'none'
        })
      }

      // Close menu when clicking outside
      mobileMenu.addEventListener('click', (e) => {
        if (e.target === mobileMenu) {
          mobileMenu.style.display = 'none'
        }
      })
    }
  }

  // Initialize
  updateNavigation()
  initMobileMenu()

  // Listen for auth changes
  supabaseBrowser.auth.onAuthStateChange((event, session) => {
    updateNavigation()
  })
</script>